<!DOCTYPE html>
<html>
<head>
<title>Python.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="python">Python</h1>
<p>Github：https://github.com/IvenStarry</p>
<p>学习视频网站：B站黑马程序员
https://www.bilibili.com/video/BV1qW4y1a7fU?p=1&amp;vd_source=6fd71d34326a08965fdb07842b0124a7</p>
<h2 id="%E7%AC%AC%E5%8D%81%E5%9B%9B%E7%AB%A0">第十四章</h2>
<h3 id="sql%E8%AF%AD%E8%A8%80-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%8B%E7%BB%8D">SQL语言 数据库介绍</h3>
<p>数据的存储：txt、excel、数据库
管理库、管理表、管理数据
数据库就是数据存储的库，是组织数据并存储数据
SQL语言是对数据库、数据进行操作、管理、查询的工具
使用数据库软件去获得库-&gt;表-&gt;数据，提供数据组织、存储的能力
使用SQL语言，完成数据的增删改查等操作</p>
<h3 id="mysql%E7%9A%84%E5%85%A5%E9%97%A8%E4%BD%BF%E7%94%A8">MySQL的入门使用</h3>
<p>show databases; 查看有哪些数据库
use 数据库名; 使用某个数据库
show tables; 查看数据库里有哪些表
exit 退出MySQL的命令行环境
图形化工具：DBeaver</p>
<h3 id="sql%E5%9F%BA%E7%A1%80%E5%92%8C%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89%E8%AF%AD%E8%A8%80ddl">SQL基础和数据定义语言DDL</h3>
<p><strong>数据定义</strong>：DDL
<strong>数据操纵</strong>：DML
<strong>数据控制</strong>：DCL
<strong>数据查询</strong>：DQL</p>
<pre class="hljs"><code><div><span class="hljs-comment"># 注释：1.单行注释 -- 注释 2.单行注释 # 注释 3.多行注释 /* 注释/*</span>
<span class="hljs-comment">-- 注释1</span>
<span class="hljs-comment"># 注释2</span>
<span class="hljs-comment">/*
 我
 是
 注释
*/</span>

<span class="hljs-comment"># SQL语言特点：大小写不敏感， ;结尾</span>
<span class="hljs-comment"># 查看数据库 show databases</span>
<span class="hljs-keyword">show</span> <span class="hljs-keyword">databases</span>;

<span class="hljs-comment"># 使用数据库 use 数据库名称</span>
<span class="hljs-keyword">use</span> world;

<span class="hljs-comment"># 查看当前数据库 select database();</span>
<span class="hljs-keyword">select</span> <span class="hljs-keyword">database</span>();

<span class="hljs-comment"># 创建数据库 create database test [charset UTF8] []内可选编码格式</span>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">database</span> <span class="hljs-keyword">test</span> <span class="hljs-keyword">charset</span> utf8;
<span class="hljs-keyword">show</span> <span class="hljs-keyword">databases</span>;

<span class="hljs-comment"># 删除数据库 drop database 数据库名称</span>
<span class="hljs-keyword">drop</span> <span class="hljs-keyword">database</span> <span class="hljs-keyword">test</span>;
<span class="hljs-keyword">show</span> <span class="hljs-keyword">databases</span>;


<span class="hljs-keyword">use</span> world;
<span class="hljs-comment"># 查看表 show tables;</span>
<span class="hljs-keyword">show</span> <span class="hljs-keyword">tables</span>;

<span class="hljs-comment"># 创建表 create table 表名称(列名称 列类型,列名称 列类型,......)</span>
<span class="hljs-comment">-- 列类型: 1.int 2.float 3.varchar(长度) 文本，长度为数字，做最大长度限制（py中的字符串） 4.date 日期类型 5.timesleep  时间戳类型</span>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> student(
    <span class="hljs-keyword">id</span> <span class="hljs-built_in">int</span>,
    <span class="hljs-keyword">name</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">10</span>),
    age <span class="hljs-built_in">int</span>
);

<span class="hljs-comment"># 删除表 drop table 表名称; drop table if exists 表名称;</span>
<span class="hljs-keyword">drop</span> <span class="hljs-keyword">table</span> student;
</div></code></pre>
<h3 id="%E6%95%B0%E6%8D%AE%E6%93%8D%E7%BA%B5%E8%AF%AD%E8%A8%80dml">数据操纵语言DML</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">use</span> world;

<span class="hljs-keyword">drop</span> <span class="hljs-keyword">table</span> student;

<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> student(
    <span class="hljs-keyword">id</span> <span class="hljs-built_in">int</span>,
    <span class="hljs-keyword">name</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">10</span>),
    age <span class="hljs-built_in">int</span>
);

<span class="hljs-comment"># 插入数据 insert into 表[(列1, 列2,.....,列N)] values(值1, 值2,.....)[, (值1, 值2,.....), (值1, 值2,.....)]</span>
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> student(<span class="hljs-keyword">id</span>) <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>), (<span class="hljs-number">2</span>), (<span class="hljs-number">3</span>);

<span class="hljs-comment"># 字符串只支持单引号</span>
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> student(<span class="hljs-keyword">id</span>, <span class="hljs-keyword">name</span>, age) <span class="hljs-keyword">values</span>(<span class="hljs-number">4</span>, <span class="hljs-string">'Iven'</span>, <span class="hljs-number">11</span>), (<span class="hljs-number">5</span>, <span class="hljs-string">'rosen'</span>, <span class="hljs-number">21</span>), (<span class="hljs-number">6</span>, <span class="hljs-string">'starry'</span>, <span class="hljs-number">41</span>);

<span class="hljs-comment"># []代表可省略 全部列插入 输入数据顺序保持一样</span>
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> student <span class="hljs-keyword">values</span>(<span class="hljs-number">7</span>, <span class="hljs-string">'bob'</span>, <span class="hljs-number">11</span>), (<span class="hljs-number">8</span>, <span class="hljs-string">'alen'</span>, <span class="hljs-number">21</span>);

<span class="hljs-comment"># 数据删除 delete from 表名称 (where 条件判断) 不选where则全部删除</span>
<span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> <span class="hljs-keyword">id</span> = <span class="hljs-number">1</span>;
<span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> <span class="hljs-keyword">id</span> &lt; <span class="hljs-number">4</span>;
<span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> <span class="hljs-keyword">id</span> &gt; <span class="hljs-number">6</span>;

<span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> age = <span class="hljs-number">21</span>;

<span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> student ;

<span class="hljs-comment"># 数据更新 update 表名 set 列=值 [where 条件判断]</span>
<span class="hljs-keyword">update</span> student <span class="hljs-keyword">set</span> <span class="hljs-keyword">name</span> = <span class="hljs-string">'Ivennn'</span> <span class="hljs-keyword">where</span> <span class="hljs-keyword">id</span> = <span class="hljs-number">4</span>;
<span class="hljs-comment"># 不选where则全部更新</span>
<span class="hljs-keyword">update</span> student <span class="hljs-keyword">set</span> <span class="hljs-keyword">name</span> = <span class="hljs-string">'Ivennn'</span>;

<span class="hljs-comment"># 课后作业</span>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> student_test(
    <span class="hljs-keyword">id</span> <span class="hljs-built_in">int</span>,
    <span class="hljs-keyword">name</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">10</span>),
    age <span class="hljs-built_in">int</span>,
    gender <span class="hljs-built_in">varchar</span>(<span class="hljs-number">10</span>)
);

<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> student_test <span class="hljs-keyword">values</span>(<span class="hljs-number">10001</span>, <span class="hljs-string">'Iven'</span>, <span class="hljs-number">22</span>, <span class="hljs-string">'男'</span>), (<span class="hljs-number">10002</span>, <span class="hljs-string">'rosenn'</span>, <span class="hljs-number">26</span>, <span class="hljs-string">'男'</span>), (<span class="hljs-number">10003</span>, <span class="hljs-string">'bob'</span>, <span class="hljs-number">21</span>, <span class="hljs-string">'女'</span>);
</div></code></pre>
<h3 id="%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80dql%E5%9F%BA%E7%A1%80%E6%9F%A5%E8%AF%A2">数据查询语言DQL_基础查询</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> student(
    <span class="hljs-keyword">id</span> <span class="hljs-built_in">int</span>,
    <span class="hljs-keyword">name</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">10</span>),
    age <span class="hljs-built_in">int</span>,
    gender <span class="hljs-built_in">varchar</span>(<span class="hljs-number">10</span>)
);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> student <span class="hljs-keyword">VALUES</span>(<span class="hljs-number">10001</span>, <span class="hljs-string">'周杰轮'</span>, <span class="hljs-number">31</span>, <span class="hljs-string">'男'</span>), (<span class="hljs-number">10002</span>, <span class="hljs-string">'王力鸿'</span>, <span class="hljs-number">33</span>, <span class="hljs-string">'男'</span>), (<span class="hljs-number">10003</span>, <span class="hljs-string">'蔡依琳'</span>, <span class="hljs-number">35</span>, <span class="hljs-string">'女'</span>), (<span class="hljs-number">10004</span>, <span class="hljs-string">'林志灵'</span>, <span class="hljs-number">36</span>, <span class="hljs-string">'女'</span>), (<span class="hljs-number">10005</span>, <span class="hljs-string">'刘德滑'</span>, <span class="hljs-number">33</span>, <span class="hljs-string">'男'</span>), (<span class="hljs-number">10006</span>, <span class="hljs-string">'张大山'</span>, <span class="hljs-number">10</span>, <span class="hljs-string">'男'</span>), (<span class="hljs-number">10007</span>, <span class="hljs-string">'刘志龙'</span>, <span class="hljs-number">11</span>, <span class="hljs-string">'男'</span>), (<span class="hljs-number">10008</span>, <span class="hljs-string">'王潇潇'</span>, <span class="hljs-number">33</span>, <span class="hljs-string">'女'</span>), (<span class="hljs-number">10009</span>, <span class="hljs-string">'张一梅'</span>, <span class="hljs-number">20</span>, <span class="hljs-string">'女'</span>), (<span class="hljs-number">10010</span>, <span class="hljs-string">'王一倩'</span>, <span class="hljs-number">13</span>, <span class="hljs-string">'女'</span>), (<span class="hljs-number">10011</span>, <span class="hljs-string">'陈一迅'</span>, <span class="hljs-number">31</span>, <span class="hljs-string">'男'</span>), (<span class="hljs-number">10012</span>, <span class="hljs-string">'张晓光'</span>, <span class="hljs-number">33</span>, <span class="hljs-string">'男'</span>), (<span class="hljs-number">10013</span>, <span class="hljs-string">'李大晓'</span>, <span class="hljs-number">15</span>, <span class="hljs-string">'男'</span>), (<span class="hljs-number">10014</span>, <span class="hljs-string">'吕甜甜'</span>, <span class="hljs-number">36</span>, <span class="hljs-string">'女'</span>), (<span class="hljs-number">10015</span>, <span class="hljs-string">'曾悦悦'</span>, <span class="hljs-number">31</span>, <span class="hljs-string">'女'</span>), (<span class="hljs-number">10016</span>, <span class="hljs-string">'刘佳慧'</span>, <span class="hljs-number">21</span>, <span class="hljs-string">'女'</span>), (<span class="hljs-number">10017</span>, <span class="hljs-string">'项羽凡'</span>, <span class="hljs-number">23</span>, <span class="hljs-string">'男'</span>), (<span class="hljs-number">10018</span>, <span class="hljs-string">'刘德强'</span>, <span class="hljs-number">26</span>, <span class="hljs-string">'男'</span>), (<span class="hljs-number">10019</span>, <span class="hljs-string">'王强强'</span>, <span class="hljs-number">11</span>, <span class="hljs-string">'男'</span>), (<span class="hljs-number">10020</span>, <span class="hljs-string">'林志慧'</span>, <span class="hljs-number">25</span>, <span class="hljs-string">'女'</span>);

<span class="hljs-comment"># select 字段列表 |* from 表 [where 条件判断]</span>
<span class="hljs-comment"># 从表中，选择某些列进行展示</span>
<span class="hljs-keyword">select</span> <span class="hljs-keyword">id</span>, <span class="hljs-keyword">name</span> <span class="hljs-keyword">from</span> student;
<span class="hljs-keyword">select</span> <span class="hljs-keyword">id</span>, <span class="hljs-keyword">name</span>, age, gender <span class="hljs-keyword">from</span> student;
<span class="hljs-comment"># * 代表查询所有</span>
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> student;
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> age &gt; <span class="hljs-number">20</span>;
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> gender = <span class="hljs-string">'男'</span>;
</div></code></pre>
<h3 id="%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80dql%E5%88%86%E7%BB%84%E8%81%9A%E5%90%88">数据查询语言DQL_分组聚合</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># 分组聚合</span>
<span class="hljs-comment"># select 字段|聚合函数 from 表 [where 条件] group by 列</span>
<span class="hljs-comment"># 聚合函数：sum(列), avg(列), min(列), max(列), count(列|*)</span>
<span class="hljs-comment"># select后非聚合函数只能有跟group by一样的对象 聚合函数无限制</span>
<span class="hljs-keyword">select</span> gender, <span class="hljs-keyword">avg</span>(age), <span class="hljs-keyword">sum</span>(age), <span class="hljs-keyword">min</span>(age), <span class="hljs-keyword">max</span>(age), <span class="hljs-keyword">count</span>(*) <span class="hljs-keyword">from</span> student <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> gender;
</div></code></pre>
<h3 id="%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80dql%E6%8E%92%E5%BA%8F%E5%88%86%E9%A1%B5">数据查询语言DQL_排序分页</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># 结果排序 对某一列进行排序</span>
<span class="hljs-comment"># select 列|聚合函数|* from 表 order by ...[asc| desc]默认升序</span>
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> age &gt; <span class="hljs-number">20</span>;
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> age &gt; <span class="hljs-number">20</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> age <span class="hljs-keyword">asc</span>;
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> age &gt; <span class="hljs-number">20</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> age <span class="hljs-keyword">desc</span>;

<span class="hljs-comment"># 结果分页限制</span>
<span class="hljs-comment"># select 列|聚合函数|* from 表 limit n[, m]</span>
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> student <span class="hljs-keyword">limit</span> <span class="hljs-number">5</span>;
<span class="hljs-comment"># 跳过前10条从第11条开始 取5个</span>
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> student <span class="hljs-keyword">limit</span> <span class="hljs-number">10</span>, <span class="hljs-number">5</span>;

<span class="hljs-comment"># 综合使用 执行顺序不可变 select from必写 其他可省略</span>
<span class="hljs-comment"># select 列|聚合函数|* from 表 where... group by... order by ...[asc| desc] limit n[, m]...</span>
<span class="hljs-keyword">select</span> age, <span class="hljs-keyword">count</span>(*) <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> age &gt; <span class="hljs-number">20</span> <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> age;
<span class="hljs-keyword">select</span> age, <span class="hljs-keyword">count</span>(*) <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> age &gt; <span class="hljs-number">20</span> <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> age;
order by age;
<span class="hljs-keyword">select</span> age, <span class="hljs-keyword">count</span>(*) <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> age &gt; <span class="hljs-number">20</span> <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> age;
order by age limit 3;
</div></code></pre>
<h3 id="python%E6%93%8D%E4%BD%9Cmysql%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8">Python操作MySQL基础使用</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># pymysql 除了使用图形化工具 也可以用编程语言执行SQL来操作数据库</span>

<span class="hljs-comment"># todo 创建到MySQL的数据库链接</span>
<span class="hljs-keyword">from</span> pymysql <span class="hljs-keyword">import</span> Connection
conn = Connection(
    host = <span class="hljs-string">"localhost"</span>,         <span class="hljs-comment"># 主机名(IP)</span>
    port = <span class="hljs-number">3306</span>,                <span class="hljs-comment"># 端口</span>
    user = <span class="hljs-string">"root"</span>,              <span class="hljs-comment"># 账户</span>
    password = <span class="hljs-string">"123456"</span>         <span class="hljs-comment"># 密码</span>
)
<span class="hljs-comment"># 获取服务器连接信息</span>
print(conn.get_server_info())

<span class="hljs-comment"># todo 创建到MySQL的数据库链接</span>
<span class="hljs-comment"># 获取游标对象 conn.cursor()</span>
cursor = conn.cursor()
<span class="hljs-comment"># 选择数据库 use = select_db</span>
conn.select_db(<span class="hljs-string">"test"</span>)
<span class="hljs-comment"># 执行SQL 用python语言可以不写;</span>
cursor.execute(<span class="hljs-string">"create table test_pymysql(id int);"</span>)
cursor.execute(<span class="hljs-string">"create table test_pymysql2(id int)"</span>)

<span class="hljs-comment"># todo 执行查询性质的SQL语句</span>
conn.select_db(<span class="hljs-string">"world"</span>)
cursor.execute(<span class="hljs-string">"select * from student"</span>)
<span class="hljs-comment"># 拿到查询结果 fetchall() 返回了一个嵌套元组</span>
results = cursor.fetchall()
print(results)
<span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> results:
    print(r)

<span class="hljs-comment"># todo 关闭链接</span>
conn.close()
</div></code></pre>
<h3 id="python%E6%93%8D%E4%BD%9Cmysql%E6%95%B0%E6%8D%AE%E6%8F%92%E5%85%A5">Python操作MySQL数据插入</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">from</span> pymysql <span class="hljs-keyword">import</span> Connection

conn = Connection(
    host=<span class="hljs-string">"localhost"</span>,
    port=<span class="hljs-number">3306</span>,
    user=<span class="hljs-string">"root"</span>,
    password=<span class="hljs-string">"123456"</span>
)

<span class="hljs-comment"># 游标对象</span>
cursor = conn.cursor()
conn.select_db(<span class="hljs-string">"world"</span>)
<span class="hljs-comment"># 插入数据</span>
cursor.execute(<span class="hljs-string">"insert into student values(10001, 'Iven', 23, '男')"</span>)
<span class="hljs-comment"># * 插入数据必须要commit确认</span>
conn.commit()
cursor.close()

<span class="hljs-comment"># 若不想手动确认，可以在构建连接对象时，添加一个参数</span>
conn = Connection(
    host=<span class="hljs-string">"localhost"</span>,
    port=<span class="hljs-number">3306</span>,
    user=<span class="hljs-string">"root"</span>,
    password=<span class="hljs-string">"123456"</span>,
    autocommit=<span class="hljs-literal">True</span>
)

cursor = conn.cursor()
conn.select_db(<span class="hljs-string">"world"</span>)
<span class="hljs-comment"># 自动插入数据</span>
cursor.execute(<span class="hljs-string">"insert into student values(10002, 'Iven', 23, '男')"</span>)
conn.close()
</div></code></pre>
<h3 id="python%E6%93%8D%E4%BD%9Cmysql%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B">Python操作MySQL综合案例</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> json
<span class="hljs-keyword">from</span> pymysql <span class="hljs-keyword">import</span> Connection

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Record</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, date, order_id, money, province)</span>:</span>
        self.date = date
        self.order_id = order_id
        self.money = money
        self.province = province
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{self.date}</span>, <span class="hljs-subst">{self.order_id}</span>, <span class="hljs-subst">{self.money}</span>, <span class="hljs-subst">{self.province}</span>"</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileReader</span>:</span>
    <span class="hljs-comment"># 但这里不能正常注释Record类 最好还是纯英文文件</span>
    <span class="hljs-comment"># def read_data(self) -&gt; list[Record]:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_data</span><span class="hljs-params">(self)</span> -&gt; list:</span>
        <span class="hljs-string">"""读取文件数据 读的数据转为Record对象 并封装在list内返回即可"""</span>
        <span class="hljs-keyword">pass</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TextFileReader</span><span class="hljs-params">(FileReader)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, path)</span>:</span>
        self.path = path
    
    <span class="hljs-comment"># 复写</span>
    <span class="hljs-comment"># def read_data(self) -&gt; list[Record]:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_data</span><span class="hljs-params">(self)</span> -&gt; list:</span>
        f = open(self.path, <span class="hljs-string">"r"</span>, encoding=<span class="hljs-string">"UTF-8"</span>)
        
        record_list = []

        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f.readlines():
            <span class="hljs-comment"># 消除换行符</span>
            line = line.strip()
            data_list = line.split(<span class="hljs-string">","</span>)
            record = Record(data_list[<span class="hljs-number">0</span>], data_list[<span class="hljs-number">1</span>], int(data_list[<span class="hljs-number">2</span>]), data_list[<span class="hljs-number">3</span>])
            record_list.append(record)
        
        f.close()

        <span class="hljs-comment"># 返回数据列表</span>
        <span class="hljs-keyword">return</span> record_list

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JsonFileReader</span><span class="hljs-params">(FileReader)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, path)</span>:</span>
        self.path = path
    
    <span class="hljs-comment"># 复写</span>
    <span class="hljs-comment"># def read_data(self) -&gt; list[Record]:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_data</span><span class="hljs-params">(self)</span> -&gt; list:</span>
        f = open(self.path, <span class="hljs-string">"r"</span>, encoding=<span class="hljs-string">"UTF-8"</span>)
        
        record_list = []

        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f.readlines():
            <span class="hljs-comment"># 消除换行符 这里可要可不要</span>
            <span class="hljs-comment"># line = line.strip()</span>
            data_dict = json.loads(line)
            record = Record(data_dict[<span class="hljs-string">'date'</span>], data_dict[<span class="hljs-string">'order_id'</span>], int(data_dict[<span class="hljs-string">'money'</span>]), data_dict[<span class="hljs-string">'province'</span>])
            record_list.append(record)
        
        f.close()
        
        <span class="hljs-comment"># 返回数据列表</span>
        <span class="hljs-keyword">return</span> record_list

text_file_reader = TextFileReader(<span class="hljs-string">"related_data/2011年1月销售数据.txt"</span>)
json_file_reader = JsonFileReader(<span class="hljs-string">"related_data/2011年2月销售数据JSON.txt"</span>)

jan_data: list[Record] = text_file_reader.read_data()
feb_data: list[Record] = json_file_reader.read_data()
<span class="hljs-comment"># 合并为一个list储存</span>
all_data : list[Record] = jan_data + feb_data

<span class="hljs-comment"># todo SQL操作</span>
conn = Connection(
    host=<span class="hljs-string">"localhost"</span>,
    port=<span class="hljs-number">3306</span>,
    password=<span class="hljs-string">"123456"</span>,
    user=<span class="hljs-string">'root'</span>,
    autocommit=<span class="hljs-literal">True</span>
)

cursor = conn.cursor()
conn.select_db(<span class="hljs-string">"py_sql"</span>)
<span class="hljs-keyword">for</span> record <span class="hljs-keyword">in</span> all_data:
    <span class="hljs-comment"># * 三种长字符串换行显示</span>
    <span class="hljs-comment"># 1.第一行末尾加\</span>
    sql = <span class="hljs-string">f"insert into orders(order_date, order_id, money, province) \
    values('<span class="hljs-subst">{record.date}</span>', '<span class="hljs-subst">{record.order_id}</span>', <span class="hljs-subst">{record.money}</span>, '<span class="hljs-subst">{record.province}</span>')"</span>
    <span class="hljs-comment"># 2.三个"</span>
    sql = <span class="hljs-string">f'''insert into orders(order_date, order_id, money, province) \
    values("<span class="hljs-subst">{record.date}</span>", "<span class="hljs-subst">{record.order_id}</span>", <span class="hljs-subst">{record.money}</span>, "<span class="hljs-subst">{record.province}</span>")'''</span>
    <span class="hljs-comment"># 3.三个'</span>
    sql = <span class="hljs-string">f"""insert into orders(order_date, order_id, money, province) \
    values('<span class="hljs-subst">{record.date}</span>', '<span class="hljs-subst">{record.order_id}</span>', <span class="hljs-subst">{record.money}</span>, '<span class="hljs-subst">{record.province}</span>')"""</span>
    <span class="hljs-comment"># print(sql)</span>
    cursor.execute(sql)
conn.close()

<span class="hljs-comment"># 课后作业</span>
f = open(<span class="hljs-string">"related_data/098_2011年2月销售数据JSON.txt"</span>, <span class="hljs-string">"a"</span>, encoding=<span class="hljs-string">"UTF-8"</span>)

conn = Connection(
    host=<span class="hljs-string">"localhost"</span>,
    port=<span class="hljs-number">3306</span>,
    password=<span class="hljs-string">"123456"</span>,
    user=<span class="hljs-string">'root'</span>,
    autocommit=<span class="hljs-literal">True</span>
)
cursor = conn.cursor()
conn.select_db(<span class="hljs-string">"py_sql"</span>)
cursor.execute(<span class="hljs-string">"select * from orders"</span>)
<span class="hljs-comment"># 返回一个元组</span>
results = cursor.fetchall()
<span class="hljs-comment"># print(results)</span>

<span class="hljs-comment"># 作业所示的文件并不是正式的json格式 所以以字典转str格式写入</span>
<span class="hljs-comment"># data_list = []</span>
<span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> results:
    <span class="hljs-comment"># 从SQL里拿出的日期是datetime.date类型 </span>
    year_month = str(data[<span class="hljs-number">0</span>])[:<span class="hljs-number">7</span>]
    <span class="hljs-keyword">if</span> year_month == <span class="hljs-string">"2011-02"</span>:
            order_date = str(data[<span class="hljs-number">0</span>])
            order_id = data[<span class="hljs-number">1</span>]
            money = data[<span class="hljs-number">2</span>]
            province = data[<span class="hljs-number">3</span>]

            data_dict = {}
            data_dict[<span class="hljs-string">'date'</span>] = order_date
            data_dict[<span class="hljs-string">'order_id'</span>] = order_id
            data_dict[<span class="hljs-string">'money'</span>] = money
            data_dict[<span class="hljs-string">'province'</span>] = province
            
            str_data_dict = str(data_dict) + <span class="hljs-string">"\n"</span>
            f.write(str_data_dict)
            <span class="hljs-comment"># data_list.append(data_dict)</span>

<span class="hljs-comment"># json_list = json.dumps(data_list, ensure_ascii=False)</span>
<span class="hljs-comment"># f.write(json_list)</span>

f.flush()
f.close()
conn.close()
</div></code></pre>
<h3 id="%E7%AC%AC%E5%8D%81%E4%BA%94%E7%AB%A0">第十五章</h3>
<p>spark是全球顶级的分布式计算框架，用于对海量数据进行大规模分布式计算，支持众多的编程语言开发，是大数据开发的核心技术。
作为python库进行数据处理或提交到spark集群进行分布式集群计算</p>

</body>
</html>
